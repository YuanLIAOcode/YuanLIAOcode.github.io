<!doctype html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="MySQL,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="Subqueries and Derived TablesSubqueriesSubqueires, which are also sometimes called inner queires or nested queries, are queries that are embedded within the context of another query. The output of a s">
<meta name="keywords" content="MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="Coursera_Managing Big Data with MySQL_Note 3">
<meta property="og:url" content="//YuanLIAOcode.github.io/2017/11/04/7.3SQL笔记3/index.html">
<meta property="og:site_name" content="Record My Life">
<meta property="og:description" content="Subqueries and Derived TablesSubqueriesSubqueires, which are also sometimes called inner queires or nested queries, are queries that are embedded within the context of another query. The output of a s">
<meta property="og:locale" content="en">
<meta property="og:image" content="//yuanliaocode.github.io/2017/11/04/7.3SQL笔记3/3.1CASE_Expression_syntax.png">
<meta property="og:image" content="//yuanliaocode.github.io/2017/11/04/7.3SQL笔记3/3.1CASE_Expression_syntax2.png">
<meta property="og:updated_time" content="2017-12-07T12:59:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coursera_Managing Big Data with MySQL_Note 3">
<meta name="twitter:description" content="Subqueries and Derived TablesSubqueriesSubqueires, which are also sometimes called inner queires or nested queries, are queries that are embedded within the context of another query. The output of a s">
<meta name="twitter:image" content="//yuanliaocode.github.io/2017/11/04/7.3SQL笔记3/3.1CASE_Expression_syntax.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="//YuanLIAOcode.github.io/2017/11/04/7.3SQL笔记3/">





  <title>Coursera_Managing Big Data with MySQL_Note 3 | Record My Life</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-102582468-1', 'auto');
  ga('send', 'pageview');
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->











</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Record My Life</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="//YuanLIAOcode.github.io/2017/11/04/7.3SQL笔记3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuan LIAO">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Record My Life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Coursera_Managing Big Data with MySQL_Note 3</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-04T02:43:05+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Subqueries-and-Derived-Tables"><a href="#Subqueries-and-Derived-Tables" class="headerlink" title="Subqueries and Derived Tables"></a>Subqueries and Derived Tables</h2><h3 id="Subqueries"><a href="#Subqueries" class="headerlink" title="Subqueries"></a>Subqueries</h3><p>Subqueires, which are also sometimes called inner queires or nested queries, are queries that are embedded within the context of another query. The output of a subquery is incorporated into the queries that surround it.</p>
<p>Subqueires can be used in <code>SELECT</code>, <code>WHERE</code>, and <code>FROM</code> clauses.</p>
<p><strong>The Main reasons to use subqueries are:</strong><br><a id="more"></a></p>
<ul>
<li>Sometimes they are the most logical way to retrieve the information you want</li>
<li>They can be used to isolate each logical part of a statement, which can be helpful for troubleshooting long and complicated queries</li>
<li>Sometimes they run faster than joins</li>
</ul>
<h5 id="Tips"><a href="#Tips" class="headerlink" title="Tips:"></a><code>Tips:</code></h5><p><strong>Subqueires must be enclosed in parentheses.</strong></p>
<p><strong>Queries that include subqueries always run the innermost subquery first, and then run subsequent queries sequentially in order from the innermost query to the outermost query.</strong></p>
<p><strong>Subqueries have a couple of rules that joins don’t:</strong></p>
<ul>
<li><code>ORDER BY</code> phrase cannot be used in subqueries (although <code>ORDER BY</code> phrase can still be used in outer queires that contain subqueires).</li>
<li>Subqueires in <code>SELECT</code> or <code>WHERE</code> clauses that return more than one row must be used in combination with operators that are explicitly designed to handle multiple valuse, such as the <code>IN</code> operator. Otherwise, subqueries in <code>SELECT</code> or <code>WHERE</code> statement can output no more than 1 row.</li>
</ul>
<ul>
<li><code>EXISTS</code> and <code>NOT EXISTS</code></li>
</ul>
<p><code>EXISTS</code> and <code>NOT EXISTS</code> perform similar functions to <code>IN</code> and <code>NOT IN</code>, but <code>EXISTS</code> can only be used in subqueries.</p>
<p>What’s more, <code>EXISTS</code>/<code>NOT EXISTS</code> are logical statements. Rather than returning raw data, per se, <code>EXISTS</code>/<code>NOT EXISTS</code> statements return a value of TRUE or FALSE.</p>
<p>As a pratical consequence, <code>EXISTS</code> statements are often writen using an asterisk (*) after the SELECT clause rather than explicit column names.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> u.user_guid <span class="keyword">AS</span> uUserID</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">users</span> u</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> d.user_guid</span><br><span class="line">              <span class="keyword">FROM</span> dogs d </span><br><span class="line">              <span class="keyword">WHERE</span> u.user_guid =d.user_guid);</span><br></pre></td></tr></table></figure>
<p><strong>is the same if we wrote:</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> u.user_guid <span class="keyword">AS</span> uUserID</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">users</span> u</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> *</span><br><span class="line">              <span class="keyword">FROM</span> dogs d </span><br><span class="line">              <span class="keyword">WHERE</span> u.user_guid =d.user_guid);</span><br></pre></td></tr></table></figure></p>
<p>Essentially, both of these queries say give us all the distinct user_guids from the users table that have a value of  <code>TRUE</code> in our EXISTS clause.</p>
<p>The results would be equivalent to an inner join with GROUP BY query.</p>
<h5 id="Importtant-points"><a href="#Importtant-points" class="headerlink" title="Importtant points:"></a>Importtant points:</h5><p>i.e:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DistinctUUsersID.user_guid <span class="keyword">AS</span> uUserID, d.user_guid <span class="keyword">AS</span> dUserID, <span class="keyword">count</span>(*) <span class="keyword">AS</span> numrows</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> u.user_guid </span><br><span class="line">      <span class="keyword">FROM</span> <span class="keyword">users</span> u) <span class="keyword">AS</span> DistinctUUsersID </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dogs d</span><br><span class="line">   <span class="keyword">ON</span> DistinctUUsersID.user_guid=d.user_guid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> DistinctUUsersID.user_guid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> numrows <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure>
<ul>
<li>First, we are required to give an alias to any derived table we create in subqueries within FROM statements. Otherwise there would be no way for the database to refer to the multiple columns within the temporary results we create.</li>
<li>Second, we need to use this alias every time we want to execute a function that uses the derived table. Remember that the results in which we are interested require a join between the dogs table and the temporary table, not the dogs table and the original users table with duplicates. That <strong>means we need to </strong>make sure we referenct the temporary table alias in the ON, GROUP BY, and SELECT clauses.</li>
<li>Third, relatedly, aliases used within subqueries can refer to tables outside of the subqueries. However, <strong>outer queries cannot refer to aliases created within subqueries</strong> unless those aliases are explictly part of subquery output. </li>
<li>Another thing to take note of is that when you use subqueries in FROM statements, the temporary table you create can have multiple columns in the output (unlike when you use subqueries in outside SELECT statements). But for that same reason, <strong>subqueries in FROM statements can be very computationally intensive</strong>. Therefore, it’s a good idea to use them sparingly, especially when you have very large data sets.</li>
</ul>
<h2 id="Useful-Logical-Functions"><a href="#Useful-Logical-Functions" class="headerlink" title="Useful Logical Functions"></a>Useful Logical Functions</h2><h3 id="If-Expressions"><a href="#If-Expressions" class="headerlink" title="If Expressions"></a>If Expressions</h3><p><code>IF ([your conditions], [value outputted if conditions are met], [value outputted if conditions are NOT met])</code></p>
<p>Multiple IF expressions can be nested to result in more than two possible outputs. <strong>When we nest IF expressions, it is important to encase each IF expression — as well as the entire IF expression put together — in parentheses.</strong></p>
<h3 id="CASE-Expressions"><a href="#CASE-Expressions" class="headerlink" title="CASE Expressions"></a>CASE Expressions</h3><ul>
<li>Make sure to include the word <code>END</code> at the end of the expression</li>
<li>CASE expressions do not require parentheses</li>
<li><code>ELSE</code> expressions are optional</li>
<li>If an <code>ELSE</code> expression is omitted, NULL values will be outputed for all rows that do not meet any of the conditions stated explicitly in the expression</li>
<li>CASE expressions can be used anywhere in a SQL statememt, including in GROUP BY, HAVING and ORDER BY clauses or the SELECT column list.</li>
</ul>
<p><img src="/2017/11/04/7.3SQL笔记3/3.1CASE_Expression_syntax.png" alt="CASE Expression syntax"></p>
<p>slightly more compact one:</p>
<p><img src="/2017/11/04/7.3SQL笔记3/3.1CASE_Expression_syntax2.png" alt="CASE Expression syntax"></p>
<p><strong>CASE expression could be used to:</strong></p>
<ul>
<li>rename or revise values in a column</li>
<li>standardize or combine several values int oone</li>
<li>Break values in a column up into multiple groups that meet specific criteria or that have specific ranges of values.</li>
</ul>
<h4 id="Order-of-operations-within-logical-expressions"><a href="#Order-of-operations-within-logical-expressions" class="headerlink" title="Order of operations within logical expressions"></a>Order of operations within logical expressions</h4><p>EVALUATION ORDER</p>
<ol>
<li>NOT</li>
<li>AND</li>
<li>OR</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/10/09/7.4Teradata笔记/" rel="next" title="Coursera_Managing Big Data with MySQL_Note Teradata">
                <i class="fa fa-chevron-left"></i> Coursera_Managing Big Data with MySQL_Note Teradata
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Yuan LIAO">
          <p class="site-author-name" itemprop="name">Yuan LIAO</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Subqueries-and-Derived-Tables"><span class="nav-number">1.</span> <span class="nav-text">Subqueries and Derived Tables</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Subqueries"><span class="nav-number">1.1.</span> <span class="nav-text">Subqueries</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Tips"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">Tips:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Importtant-points"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">Importtant points:</span></a></li></ol></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#Useful-Logical-Functions"><span class="nav-number">2.</span> <span class="nav-text">Useful Logical Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#If-Expressions"><span class="nav-number">2.1.</span> <span class="nav-text">If Expressions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CASE-Expressions"><span class="nav-number">2.2.</span> <span class="nav-text">CASE Expressions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Order-of-operations-within-logical-expressions"><span class="nav-number">2.2.1.</span> <span class="nav-text">Order of operations within logical expressions</span></a></li></ol></li></ol></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuan LIAO</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  










  






  





  

  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
